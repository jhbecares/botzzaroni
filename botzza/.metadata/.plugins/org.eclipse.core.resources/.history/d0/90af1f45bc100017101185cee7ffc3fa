/*--- ficheros de cabecera ---*/
#include "44blib.h"
#include "44b.h"
#include "def.h"
#include "mainstates.h"
/*--- variables globales ---*/

int symbol = 0;
/*--- funciones externas ---*/
//extern void D8Led_Symbol(int value);
/*--- declaracion de funciones ---*/
void Eint4567_ISR(void) __attribute__ ((interrupt ("IRQ")));


void Eint4567_ISR()
{
  //Identificar la interrupcion
  int which_int = rEXTINTPND;
  // Actualizar simbolo
  switch (which_int) {
  case 4: // 0100 -> Suponemos boton izqdo
	  switch (get_current_state()) {
	  case S1: // lee la mitad mas significativa de la dir
	  case S2: // lee mitad menos significativa de la dir
	  case S3: // lee la mitad mas significativa del dato a escribir
	  case S4: // lee la mitad menos significativa del dato a escribir
	  case S5: // escribe el dato en la direccion de la eeprom
		  // hace cosas
		  // TODO
		  break;
	  default:

		  break;
	  }
	  break;
  case 8: // 1000 // boton derecho
	// en cualquier momento el usuario puede pulsar el boton derecho y el
	  // sistema sera capaz de leer de la EEPROM la palabra que este
	  // en la ultima direccion introducida y mostrarla en el 8 segmentos

    break;
  }


  // borra los bits en EXTINTPND
  rEXTINTPND = rEXTINTPND | 0xC;
  // borra el bit pendiente en INTPND
  rI_ISPC = BIT_EINT4567;
}


